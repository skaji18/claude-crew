# claude-crew ざっくりガイド

## これは何？

Claude Code の Task tool で1セッションを複数のサブエージェント組織に変えるフレームワーク。依頼を投げると自動で分解・実行・統合してくれます。

## 仕組み

```
人間 ←→ 親（パス受け渡し係）
          │
          ├── 分解役（タスク分解）
          ├── 実働A-C（並列作業）
          ├── 集約役（結果統合）
          └── 回顧役（改善提案）
```

- **2層フラット**: 親が全サブエージェントを直接管理
- **ファイル経由**: 全やり取りはファイル。親はパスを渡すだけ
- **並列実行**: 最大10のサブエージェントが同時処理
- **1サイクル完結**: 分解→実行→集約→回顧が1コンテキストで完走

## 使い方

1. このディレクトリで Claude Code 起動: `claude`
2. やりたいことを伝える
3. 自動で処理される（進捗は逐次報告）

## ワークフロー

**Phase 1**: 依頼を独立サブタスクに分解
**Phase 1.5**: プラン妥当性の事前チェック（オプション）
**Phase 2**: 依存関係を解決しながら並列実行（Wave単位）
**Phase 3**: 全結果を統合して最終レポート作成
**Phase 4**: 失敗から改善提案、成功からスキル化提案を生成

全工程で親はファイルパスを渡すだけ。タスク内容はサブエージェント任せ。

## ファイル構成

```
claude-crew/
├── CLAUDE.md        親セッション向けルール
├── config.yaml      並列数・モデル設定
├── templates/       各役割のプロンプト
├── scripts/         検証・分析ツール
└── work/cmd_xxx/    依頼ごとの作業領域
```

## 設定でいじれるところ

`config.yaml` で以下を変更可能:

- `default_model`: デフォルトモデル（haiku/sonnet/opus）
- `max_parallel`: 並列実行上限（最大10）
- `plan_validation`: Phase 1.5 有効化
- `retrospect.enabled`: Phase 4 有効化
- `worker_max_turns`: サブエージェント最大ターン数

## 知っておくといいこと

- **ネスト不可**: サブエージェントが別サブエージェントを起動できない（Claude Code 制約）
- **Memory MCP**: 過去の知見を検索活用できる（書込は承認後のみ）
- **Phase 1 原則必須**: typo修正等の超軽微変更以外は必ずタスク分解する
- **Wave 実行**: 依存関係ありタスクは順次処理される
- **部分結果転送**: リトライ上限到達でも処理継続できる
- **自動コミット**: 改善提案承認時に自動生成される

## 詳しくは

- 全機能: [README.md](../README.md) / [README_ja.md](../README_ja.md)
- 処理フロー詳細: [docs/parent_guide.md](./parent_guide.md)
- ルール全文: [CLAUDE.md](../CLAUDE.md)
